#!/bin/bash

# AI Workflow ì´ˆê¸°í™” ìŠ¤í¬ë¦½íŠ¸
# í”„ë¡œì íŠ¸ê°€ ì‘ì—… ê°€ëŠ¥í•œ ìƒíƒœì¸ì§€ ê²€ì¦í•˜ê³  ê°œë°œ ì„œë²„ë¥¼ ì‹¤í–‰í•©ë‹ˆë‹¤.

set -e

# ìƒ‰ìƒ ì •ì˜
RED='\033[0;31m'
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
NC='\033[0m' # No Color

echo "ğŸ” í”„ë¡œì íŠ¸ ìƒíƒœ ê²€ì¦ ì¤‘..."

# Lint ê²€ì‚¬
echo -e "${YELLOW}ğŸ“ Lint ê²€ì‚¬...${NC}"
{{LINT_COMMAND}}
echo -e "${GREEN}âœ“ Lint í†µê³¼${NC}"

# Type ê²€ì‚¬
echo -e "${YELLOW}ğŸ”· Type ê²€ì‚¬...${NC}"
{{TYPECHECK_COMMAND}}
echo -e "${GREEN}âœ“ Type ê²€ì‚¬ í†µê³¼${NC}"

echo -e "${GREEN}âœ… í”„ë¡œì íŠ¸ê°€ clean ìƒíƒœì…ë‹ˆë‹¤.${NC}"

# ê°œë°œ ì„œë²„ ì‹¤í–‰ (ë°±ê·¸ë¼ìš´ë“œ)
echo ""
echo -e "${YELLOW}ğŸš€ ê°œë°œ ì„œë²„ ì‹œì‘ ì¤‘...${NC}"
{{DEV_SERVER_COMMAND}} &
DEV_SERVER_PID=$!
echo -e "${GREEN}âœ“ ê°œë°œ ì„œë²„ ì‹¤í–‰ë¨ (PID: $DEV_SERVER_PID)${NC}"

# PID ì €ì¥ (ë‚˜ì¤‘ì— ì¢…ë£Œí•  ë•Œ ì‚¬ìš©)
echo $DEV_SERVER_PID > .dev-server.pid

echo ""
echo -e "${GREEN}ğŸ‰ ì´ˆê¸°í™” ì™„ë£Œ! ì‘ì—…ì„ ì‹œì‘í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.${NC}"
echo -e "ê°œë°œ ì„œë²„ ì¢…ë£Œ: ${YELLOW}kill \$(cat .dev-server.pid)${NC}"
